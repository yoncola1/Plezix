# Plezix Hardcore Memory Saver

–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ Plezix –Ω–∞ –¥–≤–∏–∂–∫–µ Gecko.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

**Hardcore Memory Saver** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≥—Ä—É–∂–∞–µ—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –∏–∑ –ø–∞–º—è—Ç–∏ –∫–æ–≥–¥–∞:
- –°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å —Å–∏—Å—Ç–µ–º—ã –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ 20%
- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM –±—Ä–∞—É–∑–µ—Ä–æ–º –ø—Ä–µ–≤—ã—à–∞–µ—Ç 1500MB
- –í–∫–ª–∞–¥–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –±–æ–ª–µ–µ 300 —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)

–í—ã–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ –≤–∫–ª–∞–¥–æ–∫, –Ω–æ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –ø–∞–º—è—Ç–∏. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É –æ–Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–§—É–Ω–∫—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
- ‚è±Ô∏è –í—ã–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- üìä –ü–æ—Ä–æ–≥ —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏: 20%
- üíæ –ü–æ—Ä–æ–≥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–æ–º: 1500MB
- üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø—Ä–µ—Ñ–∏–∫—Å–µ `plezix.hardcore-memory-saver.`

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ—Ñ—ã

| –ü—Ä–µ—Ñ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------------------|----------|
| `enabled` | `true` | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é |
| `minInactiveDurationMs` | `300000` (5 –º–∏–Ω) | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π |
| `systemMemoryThresholdPercent` | `20` | –ü–æ—Ä–æ–≥ —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏ —Å–∏—Å—Ç–µ–º—ã (%) |
| `browserMemoryThresholdMB` | `1500` | –ü–æ—Ä–æ–≥ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–æ–º (MB) |
| `checkIntervalMs` | `30000` (30 —Å–µ–∫) | –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞–º—è—Ç–∏ |
| `minTabsCount` | `3` | –ú–∏–Ω. –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ |
| `maxTabsToUnloadPerCycle` | `2` | –ú–∞–∫—Å. –≤–∫–ª–∞–¥–æ–∫ –∑–∞ –æ–¥–∏–Ω —Ü–∏–∫–ª |
| `logLevel` | `"Info"` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |

### –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è (–≤—ã–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã):**
```javascript
user_pref("plezix.hardcore-memory-saver.minInactiveDurationMs", 120000);
user_pref("plezix.hardcore-memory-saver.systemMemoryThresholdPercent", 30);
user_pref("plezix.hardcore-memory-saver.browserMemoryThresholdMB", 1000);
```

**–ú–µ–Ω–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è (–≤—ã–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç):**
```javascript
user_pref("plezix.hardcore-memory-saver.minInactiveDurationMs", 600000);
user_pref("plezix.hardcore-memory-saver.systemMemoryThresholdPercent", 10);
user_pref("plezix.hardcore-memory-saver.browserMemoryThresholdMB", 2000);
```

**–ü–æ–ª–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ:**
```javascript
user_pref("plezix.hardcore-memory-saver.enabled", false);
```

## üìÅ –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
c:\Plezix\
‚îú‚îÄ‚îÄ browser\
‚îÇ   ‚îú‚îÄ‚îÄ components\
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tabbrowser\
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HardcoreMemorySaver.sys.mjs    # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TabUnloader.sys.mjs            # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TabUnloader
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ moz.build                       # –§–∞–π–ª —Å–±–æ—Ä–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BrowserGlue.sys.mjs                # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
‚îÇ   ‚îî‚îÄ‚îÄ app\profile\
‚îÇ       ‚îî‚îÄ‚îÄ firefox.js                         # –ü—Ä–µ—Ñ—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚îî‚îÄ‚îÄ toolkit\
    ‚îî‚îÄ‚îÄ components\
        ‚îî‚îÄ‚îÄ search\                            # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–æ–∏—Å–∫–æ–º
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1. BrowserGlue.sys.mjs
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞:
```javascript
ChromeUtils.defineESModuleGetters(lazy, {
  HardcoreMemorySaver: "resource:///modules/HardcoreMemorySaver.sys.mjs",
});

// –í _init():
lazy.HardcoreMemorySaver.init();
```

### 2. TabUnloader.sys.mjs
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –≤—ã–≥—Ä—É–∑–∫–∏:
```javascript
ChromeUtils.defineESModuleGetters(lazy, {
  HardcoreMemorySaver: "resource:///modules/HardcoreMemorySaver.sys.mjs",
});

// –í unloadTabAsync():
const memoryStats = lazy.HardcoreMemorySaver.getMemoryStats();
if (!memoryStats.shouldUnload) {
  return; // –ù–µ –≤—ã–≥—Ä—É–∂–∞—Ç—å, –ø–∞–º—è—Ç—å –≤ –Ω–æ—Ä–º–µ
}
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

–û—Ç–∫—Ä–æ–π—Ç–µ Browser Console (Ctrl+Shift+J) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
const {HardcoreMemorySaver} = ChromeUtils.import(
  "resource:///modules/HardcoreMemorySaver.sys.mjs"
);
console.log(HardcoreMemorySaver.getMemoryStats());
```

–í—ã–≤–æ–¥:
```javascript
{
  systemFreeMemoryPercent: 45,      // % —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏
  browserMemoryUsageMB: 1234,       // –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–æ–º (MB)
  shouldUnload: false,              // –ù—É–∂–Ω–æ –ª–∏ –≤—ã–≥—Ä—É–∂–∞—Ç—å
  isEnabled: true,                  // –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è
  isUnloading: false                // –ò–¥—ë—Ç –ª–∏ –≤—ã–≥—Ä—É–∑–∫–∞
}
```

### –õ–æ–≥–∏

–õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ Browser Console —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `Plezix.HardcoreMemorySaver`.

–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- `Debug` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `Info` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `Warn` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `Error` - –æ—à–∏–±–∫–∏

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—ã–≥—Ä—É–∑–∫–∏

–°–ª–µ–¥—É—é—â–∏–µ –≤–∫–ª–∞–¥–∫–∏ **–ù–ï** –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è:
- ‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ (selected)
- ‚úÖ –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ (pinned)
- ‚úÖ –í–∫–ª–∞–¥–∫–∏ —Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –º–µ–¥–∏–∞ (soundPlaying)
- ‚úÖ –í–∫–ª–∞–¥–∫–∏ Picture-in-Picture
- ‚úÖ –í–∫–ª–∞–¥–∫–∏ —Å WebRTC (–≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏)
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ (Private Browsing)
- ‚úÖ –í–∫–ª–∞–¥–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Å–∏—Å—Ç–µ–º —Å 4GB RAM
```javascript
user_pref("plezix.hardcore-memory-saver.minInactiveDurationMs", 180000);
user_pref("plezix.hardcore-memory-saver.systemMemoryThresholdPercent", 25);
user_pref("plezix.hardcore-memory-saver.browserMemoryThresholdMB", 1200);
user_pref("plezix.hardcore-memory-saver.maxTabsToUnloadPerCycle", 3);
```

### –î–ª—è —Å–∏—Å—Ç–µ–º —Å 8GB RAM
```javascript
user_pref("plezix.hardcore-memory-saver.minInactiveDurationMs", 300000);
user_pref("plezix.hardcore-memory-saver.systemMemoryThresholdPercent", 20);
user_pref("plezix.hardcore-memory-saver.browserMemoryThresholdMB", 2000);
```

### –î–ª—è —Å–∏—Å—Ç–µ–º —Å 16GB+ RAM
```javascript
user_pref("plezix.hardcore-memory-saver.minInactiveDurationMs", 600000);
user_pref("plezix.hardcore-memory-saver.systemMemoryThresholdPercent", 15);
user_pref("plezix.hardcore-memory-saver.browserMemoryThresholdMB", 4000);
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```javascript
user_pref("plezix.hardcore-memory-saver.logLevel", "Debug");
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞
–û—Ç–∫—Ä–æ–π—Ç–µ Browser Console –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
const {HardcoreMemorySaver} = ChromeUtils.import(
  "resource:///modules/HardcoreMemorySaver.sys.mjs"
);
HardcoreMemorySaver.forceUnload();
```

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **v1.0** - –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è
  - –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–≥—Ä—É–∑–∫–∏
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –±—Ä–∞—É–∑–µ—Ä–∞
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TabUnloader
  - –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ—Ñ–æ–≤

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Plezix Public License v2.0
