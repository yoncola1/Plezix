/* This Source Code Form is subject to the terms of the Plezix Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

:root {
  --liquid-glass-tint: light-dark(rgba(255, 255, 255, 0.7), rgba(24, 28, 36, 0.62));
  --liquid-glass-elevated-tint: light-dark(rgba(255, 255, 255, 0.8), rgba(30, 34, 42, 0.7));
  --liquid-glass-surface: color-mix(in srgb, var(--toolbar-bgcolor) 65%, transparent);
  --liquid-glass-surface-elevated: color-mix(in srgb, var(--lwt-accent-color, var(--toolbar-bgcolor)) 50%, transparent);
  --liquid-glass-border: light-dark(rgba(255, 255, 255, 0.45), rgba(255, 255, 255, 0.16));
  --liquid-glass-border-strong: light-dark(rgba(255, 255, 255, 0.62), rgba(255, 255, 255, 0.24));
  --liquid-glass-shadow: 0 8px 28px rgba(15, 18, 25, 0.2);
  --liquid-glass-shadow-soft: 0 3px 14px rgba(15, 18, 25, 0.12);
  --liquid-glass-highlight: linear-gradient(
    180deg,
    light-dark(rgba(255, 255, 255, 0.52), rgba(255, 255, 255, 0.22)) 0%,
    transparent 45%
  );
  --liquid-glass-blur: 22px;
  --liquid-glass-saturation: 165%;
}

:root[lwtheme] {
  --liquid-glass-surface: color-mix(in srgb, var(--lwt-accent-color) 54%, transparent);
  --liquid-glass-surface-elevated: color-mix(in srgb, var(--lwt-accent-color) 68%, transparent);
}

:root[privatebrowsingmode="temporary"] {
  --liquid-glass-surface: color-mix(in srgb, var(--toolbar-bgcolor) 58%, rgb(116, 92, 186) 22%);
  --liquid-glass-surface-elevated: color-mix(in srgb, var(--toolbar-bgcolor) 52%, rgb(116, 92, 186) 34%);
}

:where(#navigator-toolbox, #nav-bar, #TabsToolbar, #PersonalToolbar, #sidebar-box) {
  background-image: linear-gradient(145deg, var(--liquid-glass-tint), var(--liquid-glass-surface));
}

:where(#navigator-toolbox, #nav-bar, #TabsToolbar, #PersonalToolbar) {
  border-bottom: 1px solid var(--liquid-glass-border);
  box-shadow: inset 0 1px 0 var(--liquid-glass-border), var(--liquid-glass-shadow-soft);
}

:where(.tabbrowser-tab .tab-background, #urlbar-background, #searchbar, menupopup, panel, .PanelUI-subView, #sidebar-box) {
  background-color: var(--liquid-glass-surface);
  background-image: var(--liquid-glass-highlight), linear-gradient(145deg, var(--liquid-glass-tint), var(--liquid-glass-surface));
  border: 1px solid var(--liquid-glass-border);
  box-shadow: inset 0 1px 0 var(--liquid-glass-border), var(--liquid-glass-shadow);
}

:where(.tabbrowser-tab:hover .tab-background, #urlbar[focused] #urlbar-background, menupopup menuitem[_moz-menuactive], menupopup menu[_moz-menuactive], panel toolbarbutton:hover, #sidebar-header) {
  border-color: var(--liquid-glass-border-strong);
  background-color: var(--liquid-glass-surface-elevated);
}

:where(#urlbar-background, #searchbar) {
  border-radius: calc(var(--toolbarbutton-border-radius) + 6px);
}

:where(panel, menupopup, .PanelUI-subView, #widget-overflow-mainView) {
  border-radius: 12px;
  overflow: clip;
}

:where(menupopup menuitem, menupopup menu, panelview .subviewbutton) {
  border-radius: 8px;
}

:where(#sidebar-box, #sidebar, #sidebar-main, #sidebar-header) {
  background-color: transparent;
}

@supports ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  :where(#navigator-toolbox, #nav-bar, #TabsToolbar, #PersonalToolbar, .tabbrowser-tab .tab-background, #urlbar-background, #searchbar, menupopup, panel, .PanelUI-subView, #sidebar-box) {
    backdrop-filter: blur(var(--liquid-glass-blur)) saturate(var(--liquid-glass-saturation));
    -webkit-backdrop-filter: blur(var(--liquid-glass-blur)) saturate(var(--liquid-glass-saturation));
  }
}

@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  :where(#navigator-toolbox, #nav-bar, #TabsToolbar, #PersonalToolbar, .tabbrowser-tab .tab-background, #urlbar-background, #searchbar, menupopup, panel, .PanelUI-subView, #sidebar-box) {
    background-image: linear-gradient(145deg, var(--liquid-glass-elevated-tint), var(--toolbar-bgcolor));
    background-color: color-mix(in srgb, var(--toolbar-bgcolor) 90%, black 10%);
  }
}

@media (prefers-contrast) {
  :where(#navigator-toolbox, #nav-bar, #TabsToolbar, #PersonalToolbar, .tabbrowser-tab .tab-background, #urlbar-background, #searchbar, menupopup, panel, .PanelUI-subView, #sidebar-box) {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    background-image: none;
    border-color: currentColor;
    box-shadow: none;
  }
}
